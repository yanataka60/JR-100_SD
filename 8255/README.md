# JR-100_SD 8255版

PIOに8255を使ったVersionでPIOアクセス時にノイズが発生します。
PIOに6821を使ったVersionを正式Versionとしますが、入手性の良さから8255Versionも残しておきます。

開発に使用した3台のJR-100では安定動作していますが、動作が不安定な時があるとの報告もあります。

#### 2025.1.24追記　外部電源での動作が不安定でハングしてしまうときがあるとの動作報告がありました。SDカードも含めていろいろ試してもらってはいますが解消には至っていません。

#### 当方の環境で純正アダプタ、非純正電源、外部電源運用、内部電源運用、別ROMとの差替え等試しましたがどの組み合わせでも安定動作するため原因特定に至っていません。

#### 本体の個体差が何らかの影響している気がします。

#### 2025.2.8追記 現在3台のJR-100本体で各環境(純正アダプタ、非純正電源、外部電源運用、内部電源運用)での安定動作が確認されています。

## 回路図
　8255フォルダ、KiCadフォルダ内のJR-100_SD.pdfを参照してください。

[回路図](https://github.com/yanataka60/JR-100_SD/blob/main/8255/Kicad/JR-100_SD.pdf)

![JR-100_SD](https://github.com/yanataka60/JR-100_SD/blob/main/8255/Kicad/JR-100_SD_1.jpg)

## 部品
　6821版との違いは、U5が6821ではなく8255であることだけです。

|番号|品名|数量|備考|
| ------------ | ------------ | ------------ | ------------ |
|J1(J2)|50Pカードエッジコネクタ|1|せんごくネット通販 HRS CR22A-50D-2.54DSなど|
|J4|コネクタ 2Pin|1|ピンヘッダで代用するときはGNDと間違えないよう1Pinで5Vだけにしたほうが良い|
|J5|DCジャック|1|秋月電子通商 MJ-179PHなど|
||J6、J7のいずれか|||
|J6|Micro_SD_Card_Kit|1|秋月電子通商 AE-microSD-LLCNV (注1) (注2)|
|J7|MicroSD Card Adapter|1|Arduino等に使われる5V電源に対応したもの (注2)|
|U1|GAL22V10|1||
|U3|ROM 2764/28C64相当品|1||
|U5|8255|1||
|U6|Arduino_Pro_Mini_5V|1|Atmega328版を使用 168版は不可。(注3)|
|C1,C2,C5|積層セラミックコンデンサ 0.1uF|3||
|C6|電解コンデンサ 16v100uF|1||
|S1|3Pスライドスイッチ|1|秋月電子通商 SS12D01G4など|
||ピンヘッダ|2Pin分|Arduino_Pro_MiniにはA4、A5用のピンヘッダが付いていないため別途調達が必要です 秋月電子通商 PH-1x40SGなど|
||ピンソケット(任意)|26Pin分|Arduino_Pro_Miniを取り外し可能としたい場合に調達します 秋月電子通商 FHU-1x42SGなど|

JR-100_SDに外部から電源を供給する場合
|番号|品名|数量|備考|
| ------------ | ------------ | ------------ | ------------ |
||ACアダプター 5V|1|秋月電子通商 M050200-A010JPなど|

RAM($4000～$7FFF)を拡張する場合
|番号|品名|数量|備考|
| ------------ | ------------ | ------------ | ------------ |
|U4|RAM 62256相当品|1||
|C3|積層セラミックコンデンサ 0.1uF|1||

ジョイスティックポートを付ける場合
|番号|品名|数量|備考|
| ------------ | ------------ | ------------ | ------------ |
|J3|D-SUB 9Pオス基板取付型|1|マルツ 3223DB9RP1S2など|
|U2|74LS366|1||
|C4|積層セラミックコンデンサ 0.1uF|1||
|R1-R5|10KΩ|5||

リセットスイッチを使う場合
|番号|品名|数量|備考|
| ------------ | ------------ | ------------ | ------------ |
|SW1|タクトスイッチ|1|秋月電子通商 DTS-63-N-Vなど|
|J8|コネクタ 1Pin|1|リセット用ご自分の環境に合わせてください|

　　　注1)秋月電子通商　AE-microSD-LLCNVのJ1ジャンパはショートしてください。

　　　注2)J6又はJ7のどちらかを選択して取り付けてください。

### 　　注3)Arduino Pro MiniはA4、A5ピンも使っています。

### MicroSD Card Adapterを使う
　J7に取り付けます。

　MicroSD Card Adapterについているピンヘッダを除去してハンダ付けするのが一番確実ですが、J4の穴にMicroSD Card Adapterをぴったりと押しつけ、裏から多めにハンダを流し込むことでハンダ付けをする方法もあります。なお、この方法の時にはしっかりハンダ付けが出来たかテスターで導通を確認しておいた方が安心です。

　ハンダ付けに自信のない方はJ2の秋月電子通商　AE-microSD-LLCNVをお使いください。AE-microSD-LLCNVならパワーLED、アクセスLEDが付いています。

![MicroSD Card Adapter](https://github.com/yanataka60/JR-100_SD/blob/main/JPEG/MicroSD%20Card%20Adapter.JPG)

## ROMへの書込み
　8255フォルダ、ROMフォルダ内のSD.binをROMライター(TL866II Plus等)を使って2764又は28C64に書き込みます。

　2764(8KByteROM)を使っていますが、JR-100_SDからアクセスされるのは4KByte分です。

## Arduinoプログラム
　6821Versionと同様です。

## GALへの書込み
　8255フォルダ、Wincuplフォルダ内のJR100.jedをROMライター(TL866II Plus等)を使ってGAL22V10に書き込みます。

## 以下は6821版と同様です。
